#include <ncurses.h>
#include <vector>
#include <string>

void displayMenu(int highlight, const std::vector<std::string>& options) {
    int x, y;
    x = 2; // Starting position for text
    y = 6; // Adjusted y position to leave space for the header

    for (int i = 0; i < options.size(); i++) {
        if (i == highlight) {
            attron(A_REVERSE); // Highlight option (reverse colors)
        }
        mvprintw(y, x, options[i].c_str());
        attroff(A_REVERSE); // Turn off highlight
        y++;
    }
    refresh();
}

void displayHeader() {
    int x = 2; // Starting position for header text
    int y = 1; // Position for header at the top

    attron(COLOR_PAIR(1)); // Set color pair for white background and black text
    mvprintw(y, x, "Welcome to the Menu!");
    attroff(COLOR_PAIR(1)); // Reset color pair

    refresh();
}

int main() {
    initscr();                // Start ncurses mode
    clear();                  // Clear screen
    noecho();                 // Disable echoing of typed characters
    cbreak();                 // Disable line buffering
    keypad(stdscr, TRUE);     // Enable special keys (e.g., arrows)
    curs_set(0);              // Hide cursor

    // Initialize color pairs
    start_color();
    init_pair(1, COLOR_BLACK, COLOR_WHITE); // White background, black foreground

    // Menu options
    std::vector<std::string> options = {"Start", "Config", "Exit"};
    int highlight = 0; // Index of the highlighted option
    int choice = -1;   // User's choice
    int ch;

    // Main loop
    while (true) {
        clear();
        displayHeader(); // Display the header
        displayMenu(highlight, options); // Display the menu
        ch = getch(); // Get user input

        switch (ch) {
            case KEY_UP:
                highlight = (highlight - 1 + options.size()) % options.size();
                break;
            case KEY_DOWN:
                highlight = (highlight + 1) % options.size();
                break;
            case 10: // Enter key
                choice = highlight;
                break;
        }

        if (choice != -1) {
            break;
        }
    }

    // Perform action based on choice
    endwin(); // End ncurses mode
    if (choice == 0) {
        printf("Starting...\n");
    } else if (choice == 1) {
        printf("Opening Config...\n");
    } else if (choice == 2) {
        printf("Exiting...\n");
    }

    return 0;
}